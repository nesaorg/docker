
[SERVICE]
    Flush         1
    Daemon        Off
    Log_Level     info
    Parsers_File  parsers.conf

[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*/*-json.log
    Tag               docker.*
    Parser            docker
    Docker_Mode       On
    Mem_Buf_Limit     128MB
    Skip_Long_Lines   On
    Refresh_Interval  5
    Read_from_Head    true

[FILTER]
    Name    docker
    Match   docker.*
    Merge_Log On
    Keep_Log Off
    Labels  On
    Env     Off

[INPUT]
    Name              tail
    Path              /host-logs/bootstrap.log
    Tag               bootstrap
    Mem_Buf_Limit     32MB
    Read_from_Head    true

[FILTER]
    Name   modify
    Match  *
    Add    node.moniker ${MONIKER}
    Add    node.node_id ${NODE_ID}
    Add    node.public_ip ${PUBLIC_IP}

[OUTPUT]
    Name    http
    Match   *
    Host    log-signer
    Port    8787
    URI     /ingest
    Format  json_lines
    Compress gzip
    Retry_Limit False
